<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>File Integrity Checker: sqlite3controller Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">File Integrity Checker<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classsqlite3controller-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">sqlite3controller Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Sqlite3 Controller class.  
 <a href="classsqlite3controller.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sqlite3controller_8h_source.html">sqlite3controller.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for sqlite3controller:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller__coll__graph.png" border="0" usemap="#asqlite3controller_coll__map" alt="Collaboration graph"/></div>
<map name="asqlite3controller_coll__map" id="asqlite3controller_coll__map">
<area shape="rect" title="Sqlite3 Controller class." alt="" coords="5,5,173,236"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5e12813ef2d44e41238dfd8d4bbbea9a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a">sqlite3controller</a> ()</td></tr>
<tr class="memdesc:a5e12813ef2d44e41238dfd8d4bbbea9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a" title="Construct a new sqlite3controller::sqlite3controller object.">sqlite3controller::sqlite3controller</a> object.  <a href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a">More...</a><br /></td></tr>
<tr class="separator:a5e12813ef2d44e41238dfd8d4bbbea9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85b2bdd95d168c27a28476e07d36d88"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#aa85b2bdd95d168c27a28476e07d36d88">sqlite3controller</a> (char *databasename, char *<a class="el" href="mysqlcontroller_8cpp.html#a305d17d000ed63060cc0e874bf27e05c">machinename</a>)</td></tr>
<tr class="memdesc:aa85b2bdd95d168c27a28476e07d36d88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a" title="Construct a new sqlite3controller::sqlite3controller object.">sqlite3controller::sqlite3controller</a> object. The constructor is initialized with the name of the SQLite database and the name of the machine the FileIntegrityChecker application is running on.  <a href="classsqlite3controller.html#aa85b2bdd95d168c27a28476e07d36d88">More...</a><br /></td></tr>
<tr class="separator:aa85b2bdd95d168c27a28476e07d36d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02bd62582a0c53efbe5b08ce570e42d0"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a02bd62582a0c53efbe5b08ce570e42d0">~sqlite3controller</a> ()</td></tr>
<tr class="memdesc:a02bd62582a0c53efbe5b08ce570e42d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the <a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a" title="Construct a new sqlite3controller::sqlite3controller object.">sqlite3controller::sqlite3controller</a> object.  <a href="classsqlite3controller.html#a02bd62582a0c53efbe5b08ce570e42d0">More...</a><br /></td></tr>
<tr class="separator:a02bd62582a0c53efbe5b08ce570e42d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6ff837161930eb903754d5688f1b9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a7d6ff837161930eb903754d5688f1b9b">initdb</a> ()</td></tr>
<tr class="memdesc:a7d6ff837161930eb903754d5688f1b9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the SQLite database with the supplied databasename. The function will determine if the SQLite database already exists. If it does exist then the database is opened. If it does not exist, the database will be created and then a call to createTables is made to create the tables required to store the data.  <a href="classsqlite3controller.html#a7d6ff837161930eb903754d5688f1b9b">More...</a><br /></td></tr>
<tr class="separator:a7d6ff837161930eb903754d5688f1b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab092ae9a83a7a124a5ca19a202f6243a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#ab092ae9a83a7a124a5ca19a202f6243a">closedb</a> ()</td></tr>
<tr class="memdesc:ab092ae9a83a7a124a5ca19a202f6243a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the database after use.  <a href="classsqlite3controller.html#ab092ae9a83a7a124a5ca19a202f6243a">More...</a><br /></td></tr>
<tr class="separator:ab092ae9a83a7a124a5ca19a202f6243a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c940ac721d94e09be08e38eb0e5ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#ac0c940ac721d94e09be08e38eb0e5ca4">setDATABASENAME</a> (char *<a class="el" href="mysqlcontroller_8cpp.html#aa1d4dd60015ed611b5141e9472985b88">dbasename</a>)</td></tr>
<tr class="memdesc:ac0c940ac721d94e09be08e38eb0e5ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the name of the SQLite database.  <a href="classsqlite3controller.html#ac0c940ac721d94e09be08e38eb0e5ca4">More...</a><br /></td></tr>
<tr class="separator:ac0c940ac721d94e09be08e38eb0e5ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87910e834388b6f11c8493f10fd6a576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a87910e834388b6f11c8493f10fd6a576">setMACHINENAME</a> (char *<a class="el" href="mysqlcontroller_8cpp.html#a305d17d000ed63060cc0e874bf27e05c">machinename</a>)</td></tr>
<tr class="memdesc:a87910e834388b6f11c8493f10fd6a576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the machine name where the FileIntegrityApplication is running on.  <a href="classsqlite3controller.html#a87910e834388b6f11c8493f10fd6a576">More...</a><br /></td></tr>
<tr class="separator:a87910e834388b6f11c8493f10fd6a576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ffbf500e8d1d203bd264e221ee833a2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a6ffbf500e8d1d203bd264e221ee833a2">getDATABASENAME</a> ()</td></tr>
<tr class="memdesc:a6ffbf500e8d1d203bd264e221ee833a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the name of the SQLite database.  <a href="classsqlite3controller.html#a6ffbf500e8d1d203bd264e221ee833a2">More...</a><br /></td></tr>
<tr class="separator:a6ffbf500e8d1d203bd264e221ee833a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aa0232afbc7a8d2b71d330c607c5b40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a9aa0232afbc7a8d2b71d330c607c5b40">createTables</a> ()</td></tr>
<tr class="memdesc:a9aa0232afbc7a8d2b71d330c607c5b40"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is called when a new SQLite database is created. The following tables are created:<br  />
.  <a href="classsqlite3controller.html#a9aa0232afbc7a8d2b71d330c607c5b40">More...</a><br /></td></tr>
<tr class="separator:a9aa0232afbc7a8d2b71d330c607c5b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24d1eff1c881ec79c608d4fbd5207b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#ad24d1eff1c881ec79c608d4fbd5207b3">save_file_info</a> (const char *fname, const char *dirname, char *lastmodified, uintmax_t filesize, const char *hashval=NULL)</td></tr>
<tr class="memdesc:ad24d1eff1c881ec79c608d4fbd5207b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the details of the file.  <a href="classsqlite3controller.html#ad24d1eff1c881ec79c608d4fbd5207b3">More...</a><br /></td></tr>
<tr class="separator:ad24d1eff1c881ec79c608d4fbd5207b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bda68c0ea1d995b4fcf60965ab433a6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a6bda68c0ea1d995b4fcf60965ab433a6">save_dir_info</a> (const char *dirname)</td></tr>
<tr class="memdesc:a6bda68c0ea1d995b4fcf60965ab433a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the details of the directory.  <a href="classsqlite3controller.html#a6bda68c0ea1d995b4fcf60965ab433a6">More...</a><br /></td></tr>
<tr class="separator:a6bda68c0ea1d995b4fcf60965ab433a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:afad285c88925ab4bb987583563c11d8a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a">checkIfDirectoryExist</a> (const char *dirname)</td></tr>
<tr class="memdesc:afad285c88925ab4bb987583563c11d8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the directory exists in the database.  <a href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a">More...</a><br /></td></tr>
<tr class="separator:afad285c88925ab4bb987583563c11d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96b9af7291ed73ed8b7da9b3e36c5983"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlite3controller.html#a96b9af7291ed73ed8b7da9b3e36c5983">checkIfFileExist</a> (const char *fname, const char *dirname)</td></tr>
<tr class="memdesc:a96b9af7291ed73ed8b7da9b3e36c5983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the file exists in the database.  <a href="classsqlite3controller.html#a96b9af7291ed73ed8b7da9b3e36c5983">More...</a><br /></td></tr>
<tr class="separator:a96b9af7291ed73ed8b7da9b3e36c5983"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Sqlite3 Controller class. </p>
<p >The class that handles the SQL functions for creating, updating, and adding files and directories attributes to a Sqlite3 database. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5e12813ef2d44e41238dfd8d4bbbea9a" name="a5e12813ef2d44e41238dfd8d4bbbea9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e12813ef2d44e41238dfd8d4bbbea9a">&#9670;&#160;</a></span>sqlite3controller() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlite3controller::sqlite3controller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a" title="Construct a new sqlite3controller::sqlite3controller object.">sqlite3controller::sqlite3controller</a> object. </p>
<div class="fragment"><div class="line"><span class="lineno">   10</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa85b2bdd95d168c27a28476e07d36d88" name="aa85b2bdd95d168c27a28476e07d36d88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa85b2bdd95d168c27a28476e07d36d88">&#9670;&#160;</a></span>sqlite3controller() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlite3controller::sqlite3controller </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>databasename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>machinename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a" title="Construct a new sqlite3controller::sqlite3controller object.">sqlite3controller::sqlite3controller</a> object. The constructor is initialized with the name of the SQLite database and the name of the machine the FileIntegrityChecker application is running on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databasename</td><td></td></tr>
    <tr><td class="paramname">machinename</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   12</span>                                                                          {</div>
<div class="line"><span class="lineno">   13</span>    <a class="code hl_variable" href="sqlite3controller_8cpp.html#aadf24962fe0ba651d19e77bd6ed61b51">sqlite3_mname</a> = <a class="code hl_variable" href="mysqlcontroller_8cpp.html#a305d17d000ed63060cc0e874bf27e05c">machinename</a>;</div>
<div class="line"><span class="lineno">   14</span>    <a class="code hl_variable" href="sqlite3controller_8cpp.html#a89983a6d628aa726003d2a29bc372df4">sqlite3_dbasename</a> = databasename;</div>
<div class="line"><span class="lineno">   15</span>}</div>
<div class="ttc" id="amysqlcontroller_8cpp_html_a305d17d000ed63060cc0e874bf27e05c"><div class="ttname"><a href="mysqlcontroller_8cpp.html#a305d17d000ed63060cc0e874bf27e05c">machinename</a></div><div class="ttdeci">char * machinename</div><div class="ttdef"><b>Definition:</b> mysqlcontroller.cpp:12</div></div>
<div class="ttc" id="asqlite3controller_8cpp_html_a89983a6d628aa726003d2a29bc372df4"><div class="ttname"><a href="sqlite3controller_8cpp.html#a89983a6d628aa726003d2a29bc372df4">sqlite3_dbasename</a></div><div class="ttdeci">char * sqlite3_dbasename</div><div class="ttdef"><b>Definition:</b> sqlite3controller.cpp:7</div></div>
<div class="ttc" id="asqlite3controller_8cpp_html_aadf24962fe0ba651d19e77bd6ed61b51"><div class="ttname"><a href="sqlite3controller_8cpp.html#aadf24962fe0ba651d19e77bd6ed61b51">sqlite3_mname</a></div><div class="ttdeci">char * sqlite3_mname</div><div class="ttdef"><b>Definition:</b> sqlite3controller.cpp:8</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02bd62582a0c53efbe5b08ce570e42d0" name="a02bd62582a0c53efbe5b08ce570e42d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02bd62582a0c53efbe5b08ce570e42d0">&#9670;&#160;</a></span>~sqlite3controller()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sqlite3controller::~sqlite3controller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy the <a class="el" href="classsqlite3controller.html#a5e12813ef2d44e41238dfd8d4bbbea9a" title="Construct a new sqlite3controller::sqlite3controller object.">sqlite3controller::sqlite3controller</a> object. </p>
<div class="fragment"><div class="line"><span class="lineno">   18</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afad285c88925ab4bb987583563c11d8a" name="afad285c88925ab4bb987583563c11d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afad285c88925ab4bb987583563c11d8a">&#9670;&#160;</a></span>checkIfDirectoryExist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int sqlite3controller::checkIfDirectoryExist </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the directory exists in the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td>Relative name of the directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 for yes, 0 for no</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                                                                {</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordtype">char</span> *zErrMsg = 0;</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordtype">char</span> *sql = <span class="stringliteral">&quot;SELECT id FROM directories WHERE dirname = ? AND machinename = ?; &quot;</span>;</div>
<div class="line"><span class="lineno">  132</span>    sqlite3_stmt * <a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>;</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordtype">int</span> retVal = 0;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    rc = sqlite3_prepare_v3(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, sql, -1, 0, &amp;<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, NULL);</div>
<div class="line"><span class="lineno">  136</span>    </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">if</span> (rc == SQLITE_OK) {        </div>
<div class="line"><span class="lineno">  138</span>        sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 1, dirname, -1, NULL);</div>
<div class="line"><span class="lineno">  139</span>        sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 2, <a class="code hl_variable" href="sqlite3controller_8cpp.html#aadf24962fe0ba651d19e77bd6ed61b51">sqlite3_mname</a>, -1, NULL);</div>
<div class="line"><span class="lineno">  140</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  141</span>        </div>
<div class="line"><span class="lineno">  142</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to execute statement: %s\n&quot;</span>, sqlite3_errmsg(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>));</div>
<div class="line"><span class="lineno">  143</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  144</span>    }</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">while</span>(sqlite3_step(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>) == SQLITE_ROW)</div>
<div class="line"><span class="lineno">  147</span>    {</div>
<div class="line"><span class="lineno">  148</span>        retVal = sqlite3_column_int(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>,0);</div>
<div class="line"><span class="lineno">  149</span>    }</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    sqlite3_finalize(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>);</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">return</span> retVal;</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>}</div>
<div class="ttc" id="a_s_q_lite_helper_8cpp_html_a67d1f816562e1a4851f044e829476aed"><div class="ttname"><a href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a></div><div class="ttdeci">sqlite3_stmt * pStmt</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.cpp:42</div></div>
<div class="ttc" id="asqlite3controller_8cpp_html_ad6e663497d2c934364b3bcf07496b30b"><div class="ttname"><a href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a></div><div class="ttdeci">sqlite3 * db</div><div class="ttdef"><b>Definition:</b> sqlite3controller.cpp:6</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_afad285c88925ab4bb987583563c11d8a_icgraph.png" border="0" usemap="#aclasssqlite3controller_afad285c88925ab4bb987583563c11d8a_icgraph" alt=""/></div>
<map name="aclasssqlite3controller_afad285c88925ab4bb987583563c11d8a_icgraph" id="aclasssqlite3controller_afad285c88925ab4bb987583563c11d8a_icgraph">
<area shape="rect" title="Checks if the directory exists in the database." alt="" coords="645,69,791,109"/>
<area shape="rect" href="classsqlite3controller.html#a96b9af7291ed73ed8b7da9b3e36c5983" title="Checks if the file exists in the database." alt="" coords="476,5,597,45"/>
<area shape="rect" href="classsqlite3controller.html#a6bda68c0ea1d995b4fcf60965ab433a6" title="Save the details of the directory." alt="" coords="476,133,597,173"/>
<area shape="rect" href="classsqlite3controller.html#ad24d1eff1c881ec79c608d4fbd5207b3" title="Save the details of the file." alt="" coords="476,69,597,109"/>
<area shape="rect" href="classfileintegritychecker.html#af2fb66e054e9f613677746f6f3dde0a3" title="Get the directories files object." alt="" coords="283,76,428,116"/>
<area shape="rect" href="classfileintegritychecker.html#ab064f5cb87b4a7d8c557a32d764a131a" title=" " alt="" coords="104,105,235,145"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,113,56,138"/>
</map>
</div>

</div>
</div>
<a id="a96b9af7291ed73ed8b7da9b3e36c5983" name="a96b9af7291ed73ed8b7da9b3e36c5983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b9af7291ed73ed8b7da9b3e36c5983">&#9670;&#160;</a></span>checkIfFileExist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int sqlite3controller::checkIfFileExist </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the file exists in the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>Absolute name of the file name. </td></tr>
    <tr><td class="paramname">dirname</td><td>Relative name of the directory. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 for yes, 0 for no</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td></td></tr>
    <tr><td class="paramname">dirname</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  165</span>                                                                              {</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordtype">char</span> *zErrMsg = 0;</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordtype">char</span> *sql = <span class="stringliteral">&quot;SELECT id FROM files WHERE dirid = ? AND filename = ?; &quot;</span>;</div>
<div class="line"><span class="lineno">  169</span>    sqlite3_stmt * <a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>;</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordtype">int</span> retVal = 0;</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordtype">int</span> dirId = <a class="code hl_function" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a">checkIfDirectoryExist</a>(dirname);</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    rc = sqlite3_prepare_v3(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, sql, -1, 0, &amp;<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, NULL);</div>
<div class="line"><span class="lineno">  175</span>    </div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">if</span> (rc == SQLITE_OK) {        </div>
<div class="line"><span class="lineno">  177</span>        sqlite3_bind_int(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 1, dirId);</div>
<div class="line"><span class="lineno">  178</span>        sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 2, fname, -1, NULL);</div>
<div class="line"><span class="lineno">  179</span>        sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 3, <a class="code hl_variable" href="sqlite3controller_8cpp.html#aadf24962fe0ba651d19e77bd6ed61b51">sqlite3_mname</a>, -1, NULL);</div>
<div class="line"><span class="lineno">  180</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  181</span>        </div>
<div class="line"><span class="lineno">  182</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to execute statement: %s\n&quot;</span>, sqlite3_errmsg(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>));</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    rc = sqlite3_step(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>);</div>
<div class="line"><span class="lineno">  187</span>    </div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">while</span>(sqlite3_step(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>) == SQLITE_ROW)</div>
<div class="line"><span class="lineno">  189</span>    {</div>
<div class="line"><span class="lineno">  190</span>        retVal = sqlite3_column_int(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>,0);</div>
<div class="line"><span class="lineno">  191</span>    }</div>
<div class="line"><span class="lineno">  192</span>        </div>
<div class="line"><span class="lineno">  193</span>    sqlite3_finalize(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>);</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">return</span> retVal;</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>}</div>
<div class="ttc" id="aclasssqlite3controller_html_afad285c88925ab4bb987583563c11d8a"><div class="ttname"><a href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a">sqlite3controller::checkIfDirectoryExist</a></div><div class="ttdeci">int checkIfDirectoryExist(const char *dirname)</div><div class="ttdoc">Checks if the directory exists in the database.</div><div class="ttdef"><b>Definition:</b> sqlite3controller.cpp:128</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_a96b9af7291ed73ed8b7da9b3e36c5983_cgraph.png" border="0" usemap="#aclasssqlite3controller_a96b9af7291ed73ed8b7da9b3e36c5983_cgraph" alt=""/></div>
<map name="aclasssqlite3controller_a96b9af7291ed73ed8b7da9b3e36c5983_cgraph" id="aclasssqlite3controller_a96b9af7291ed73ed8b7da9b3e36c5983_cgraph">
<area shape="rect" title="Checks if the file exists in the database." alt="" coords="5,5,127,45"/>
<area shape="rect" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a" title="Checks if the directory exists in the database." alt="" coords="175,5,320,45"/>
</map>
</div>

</div>
</div>
<a id="ab092ae9a83a7a124a5ca19a202f6243a" name="ab092ae9a83a7a124a5ca19a202f6243a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab092ae9a83a7a124a5ca19a202f6243a">&#9670;&#160;</a></span>closedb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlite3controller::closedb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the database after use. </p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                                {</div>
<div class="line"><span class="lineno">   54</span>    sqlite3_close_v2(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>);</div>
<div class="line"><span class="lineno">   55</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_ab092ae9a83a7a124a5ca19a202f6243a_icgraph.png" border="0" usemap="#aclasssqlite3controller_ab092ae9a83a7a124a5ca19a202f6243a_icgraph" alt=""/></div>
<map name="aclasssqlite3controller_ab092ae9a83a7a124a5ca19a202f6243a_icgraph" id="aclasssqlite3controller_ab092ae9a83a7a124a5ca19a202f6243a_icgraph">
<area shape="rect" title="Close the database after use." alt="" coords="340,5,461,45"/>
<area shape="rect" href="classfileintegritychecker.html#aeb559134d644a9263fc9ab8a25ecf333" title=" " alt="" coords="104,5,292,45"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,56,38"/>
</map>
</div>

</div>
</div>
<a id="a9aa0232afbc7a8d2b71d330c607c5b40" name="a9aa0232afbc7a8d2b71d330c607c5b40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aa0232afbc7a8d2b71d330c607c5b40">&#9670;&#160;</a></span>createTables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlite3controller::createTables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is called when a new SQLite database is created. The following tables are created:<br  />
. </p>
<div align="center"><b>directories Table - used to store the details of the directories found during the scan.</b></div> <table class="doxtable">
<tr>
<th>Field name</th><th>Description </th></tr>
<tr>
<td>id</td><td>the auto generated id for the directory entry </td></tr>
<tr>
<td>dirname</td><td>relative path and name of the directory </td></tr>
<tr>
<td>dateadded</td><td>the date the directory was added to the table </td></tr>
<tr>
<td>status</td><td>Either NEW or VERIFIED. A NEW status is set when a directory is seen by the scanner the first time. VERIFIED if the scanner verifies the directory was seen again. </td></tr>
<tr>
<td>dataverified</td><td>This is the date the VERIFIED directory was verified by the scanner. </td></tr>
<tr>
<td>machinename</td><td>name of the machine where the scanner is running.</td></tr>
</table>
<div><br  />
</div> <div align="center"><b>files Table - used to store the details of the files found during the scan.</b></div> <table class="doxtable">
<tr>
<th>Field name</th><th>Description </th></tr>
<tr>
<td>id</td><td>the auto generated id for the file entry </td></tr>
<tr>
<td>dirid</td><td>The ID of the Directory where the file is located. </td></tr>
<tr>
<td>dateadded</td><td>the date the file was added to the table </td></tr>
<tr>
<td>filename</td><td>The absolute name of the file. The relative path can be pulled together using the directory reference via the dirid. </td></tr>
<tr>
<td>hashedvalue</td><td>The hashed value of the file if the hashed value flag is set to true. The default value is NOVAL. </td></tr>
<tr>
<td>hashedvaluechanged</td><td>A flag to indicate the hashed value changed and all changes are added to the changes table. </td></tr>
<tr>
<td>lastmodified</td><td>The date the file was last modified. </td></tr>
<tr>
<td>hashedvaluechanged</td><td>A flag to indicate the last modified changed and all changes are added to the changes table. </td></tr>
<tr>
<td>filesize</td><td>The file size of the file in bytes. </td></tr>
<tr>
<td>filesizechanged</td><td>A flag to indicate the file size changed and all changes are added to the changes table.</td></tr>
</table>
<div align="center"><b>changes Table - used to store the changed attributes for files.</b></div> <table class="doxtable">
<tr>
<th>Field name</th><th>Description </th></tr>
<tr>
<td>id</td><td>the auto generated id for the change entry </td></tr>
<tr>
<td>fileid</td><td>The ID of the file that has changed. </td></tr>
<tr>
<td>datechanged</td><td>the date the change was added to the table </td></tr>
<tr>
<td>textvalue</td><td>The text value that has changed. The default value is NULL. </td></tr>
<tr>
<td>intvalue</td><td>The integer value that has changed. The default value is -1. </td></tr>
<tr>
<td>attributechanged</td><td>The file attribute that changed.</td></tr>
</table>
<div class="fragment"><div class="line"><span class="lineno">   58</span>                                     {</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordtype">char</span> *dirtable_sql;</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordtype">char</span> *filetable_sql;</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordtype">char</span> *changestable_sql;</div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordtype">char</span> *zErrMsg = 0;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    dirtable_sql = <span class="stringliteral">&quot;CREATE TABLE IF NOT EXISTS directories(&quot;</span>  \</div>
<div class="line"><span class="lineno">   66</span>      <span class="stringliteral">&quot;id INTEGER PRIMARY KEY AUTOINCREMENT,&quot;</span> \</div>
<div class="line"><span class="lineno">   67</span>      <span class="stringliteral">&quot;dirname           TEXT,&quot;</span> \</div>
<div class="line"><span class="lineno">   68</span>      <span class="stringliteral">&quot;dateadded         TEXT,&quot;</span> \</div>
<div class="line"><span class="lineno">   69</span>      <span class="stringliteral">&quot;status        CHAR(50) DEFAULT &#39;NEW&#39;,&quot;</span> \</div>
<div class="line"><span class="lineno">   70</span>      <span class="stringliteral">&quot;dateverified      TEXT,&quot;</span> \ </div>
<div class="line"><span class="lineno">   71</span>      <span class="stringliteral">&quot;machinename       TEXT);&quot;</span>;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    filetable_sql = <span class="stringliteral">&quot;CREATE TABLE IF NOT EXISTS files(&quot;</span>  \</div>
<div class="line"><span class="lineno">   74</span>      <span class="stringliteral">&quot;id INTEGER PRIMARY KEY AUTOINCREMENT,&quot;</span> \</div>
<div class="line"><span class="lineno">   75</span>      <span class="stringliteral">&quot;dirid           int DEFAULT 0,&quot;</span> \</div>
<div class="line"><span class="lineno">   76</span>      <span class="stringliteral">&quot;dateadded         TEXT,&quot;</span> \</div>
<div class="line"><span class="lineno">   77</span>      <span class="stringliteral">&quot;filename      TEXT,&quot;</span> \</div>
<div class="line"><span class="lineno">   78</span>      <span class="stringliteral">&quot;hashedvalue      TEXT DEFAULT &#39;NOVAL&#39;,&quot;</span> \</div>
<div class="line"><span class="lineno">   79</span>      <span class="stringliteral">&quot;hashedvaluechanged      int DEFAULT 0,&quot;</span> \</div>
<div class="line"><span class="lineno">   80</span>      <span class="stringliteral">&quot;lastmodified      TEXT,&quot;</span> \</div>
<div class="line"><span class="lineno">   81</span>      <span class="stringliteral">&quot;lastmodifiedchanged      int DEFAULT 0,&quot;</span> \</div>
<div class="line"><span class="lineno">   82</span>      <span class="stringliteral">&quot;filesize    int,&quot;</span> \</div>
<div class="line"><span class="lineno">   83</span>      <span class="stringliteral">&quot;filesizechanged int DEFAULT 0); &quot;</span>;</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    changestable_sql = <span class="stringliteral">&quot;CREATE TABLE IF NOT EXISTS changes(&quot;</span> \</div>
<div class="line"><span class="lineno">   86</span>      <span class="stringliteral">&quot;id INTEGER PRIMARY KEY AUTOINCREMENT,&quot;</span> \</div>
<div class="line"><span class="lineno">   87</span>      <span class="stringliteral">&quot;fileid int DEFAULT 0,&quot;</span> \</div>
<div class="line"><span class="lineno">   88</span>      <span class="stringliteral">&quot;datechanged TEXT DEFAULT NULL,&quot;</span> \</div>
<div class="line"><span class="lineno">   89</span>      <span class="stringliteral">&quot;attributechanged TEXT DEFAULT NULL,&quot;</span> \</div>
<div class="line"><span class="lineno">   90</span>      <span class="stringliteral">&quot;textvalue TEXT DEFAULT NULL,&quot;</span> \</div>
<div class="line"><span class="lineno">   91</span>      <span class="stringliteral">&quot;intvalue INT DEFAULT -1);&quot;</span>;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="comment">/* Execute SQL statement */</span></div>
<div class="line"><span class="lineno">   94</span>    rc = sqlite3_exec(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, dirtable_sql, NULL, 0, &amp;zErrMsg);</div>
<div class="line"><span class="lineno">   95</span>   </div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span>( rc != SQLITE_OK ){</div>
<div class="line"><span class="lineno">   97</span>        fprintf(stderr, <span class="stringliteral">&quot;SQL error: %s\n&quot;</span>, zErrMsg);</div>
<div class="line"><span class="lineno">   98</span>        sqlite3_free(zErrMsg);</div>
<div class="line"><span class="lineno">   99</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  100</span>        fprintf(stdout, <span class="stringliteral">&quot;Table created successfully\n&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    rc = sqlite3_exec(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, filetable_sql, NULL, 0, &amp;zErrMsg);</div>
<div class="line"><span class="lineno">  104</span>    </div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span>( rc != SQLITE_OK ){</div>
<div class="line"><span class="lineno">  106</span>        fprintf(stderr, <span class="stringliteral">&quot;SQL error: %s\n&quot;</span>, zErrMsg);</div>
<div class="line"><span class="lineno">  107</span>        sqlite3_free(zErrMsg);</div>
<div class="line"><span class="lineno">  108</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  109</span>        fprintf(stdout, <span class="stringliteral">&quot;Table created successfully\n&quot;</span>);</div>
<div class="line"><span class="lineno">  110</span>    }</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    rc = sqlite3_exec(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, changestable_sql, NULL, 0, &amp;zErrMsg);</div>
<div class="line"><span class="lineno">  113</span>    </div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">if</span>( rc != SQLITE_OK ){</div>
<div class="line"><span class="lineno">  115</span>        fprintf(stderr, <span class="stringliteral">&quot;SQL error: %s\n&quot;</span>, zErrMsg);</div>
<div class="line"><span class="lineno">  116</span>        sqlite3_free(zErrMsg);</div>
<div class="line"><span class="lineno">  117</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  118</span>        fprintf(stdout, <span class="stringliteral">&quot;Table created successfully\n&quot;</span>);</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_a9aa0232afbc7a8d2b71d330c607c5b40_icgraph.png" border="0" usemap="#aclasssqlite3controller_a9aa0232afbc7a8d2b71d330c607c5b40_icgraph" alt=""/></div>
<map name="aclasssqlite3controller_a9aa0232afbc7a8d2b71d330c607c5b40_icgraph" id="aclasssqlite3controller_a9aa0232afbc7a8d2b71d330c607c5b40_icgraph">
<area shape="rect" title="This is called when a new SQLite database is created. The following tables are created: ." alt="" coords="496,5,617,45"/>
<area shape="rect" href="classsqlite3controller.html#a7d6ff837161930eb903754d5688f1b9b" title="Initializes the SQLite database with the supplied databasename. The function will determine if the SQ..." alt="" coords="327,5,448,45"/>
<area shape="rect" href="classfileintegritychecker.html#ad83727702919ed588145f7e9f9f183d7" title=" " alt="" coords="104,5,279,45"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,56,38"/>
</map>
</div>

</div>
</div>
<a id="a6ffbf500e8d1d203bd264e221ee833a2" name="a6ffbf500e8d1d203bd264e221ee833a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ffbf500e8d1d203bd264e221ee833a2">&#9670;&#160;</a></span>getDATABASENAME()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * sqlite3controller::getDATABASENAME </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the name of the SQLite database. </p>
<dl class="section return"><dt>Returns</dt><dd>char* </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   31</span>                                         {</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="sqlite3controller_8cpp.html#a89983a6d628aa726003d2a29bc372df4">sqlite3_dbasename</a>;</div>
<div class="line"><span class="lineno">   33</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d6ff837161930eb903754d5688f1b9b" name="a7d6ff837161930eb903754d5688f1b9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6ff837161930eb903754d5688f1b9b">&#9670;&#160;</a></span>initdb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlite3controller::initdb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the SQLite database with the supplied databasename. The function will determine if the SQLite database already exists. If it does exist then the database is opened. If it does not exist, the database will be created and then a call to createTables is made to create the tables required to store the data. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classsqlite3controller.html#a9aa0232afbc7a8d2b71d330c607c5b40" title="This is called when a new SQLite database is created. The following tables are created: .">createTables()</a> </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   37</span>                               {</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordtype">char</span> *zErrMsg = 0;</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">   40</span>   </div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">/* Open database */</span></div>
<div class="line"><span class="lineno">   42</span>    rc = sqlite3_open_v2(<a class="code hl_variable" href="sqlite3controller_8cpp.html#a89983a6d628aa726003d2a29bc372df4">sqlite3_dbasename</a>, &amp;<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE, NULL);</div>
<div class="line"><span class="lineno">   43</span>   </div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">if</span>( rc ) {</div>
<div class="line"><span class="lineno">   45</span>        fprintf(stderr, <span class="stringliteral">&quot;\nIn initdb can&#39;t open database: %s\n&quot;</span>, sqlite3_errmsg(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>));</div>
<div class="line"><span class="lineno">   46</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   47</span>        fprintf(stderr, <span class="stringliteral">&quot;\nOpened database successfully\n&quot;</span>);</div>
<div class="line"><span class="lineno">   48</span>        <a class="code hl_function" href="classsqlite3controller.html#a9aa0232afbc7a8d2b71d330c607c5b40">createTables</a>();</div>
<div class="line"><span class="lineno">   49</span>    }</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>}</div>
<div class="ttc" id="aclasssqlite3controller_html_a9aa0232afbc7a8d2b71d330c607c5b40"><div class="ttname"><a href="classsqlite3controller.html#a9aa0232afbc7a8d2b71d330c607c5b40">sqlite3controller::createTables</a></div><div class="ttdeci">void createTables()</div><div class="ttdoc">This is called when a new SQLite database is created. The following tables are created: .</div><div class="ttdef"><b>Definition:</b> sqlite3controller.cpp:58</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_a7d6ff837161930eb903754d5688f1b9b_cgraph.png" border="0" usemap="#aclasssqlite3controller_a7d6ff837161930eb903754d5688f1b9b_cgraph" alt=""/></div>
<map name="aclasssqlite3controller_a7d6ff837161930eb903754d5688f1b9b_cgraph" id="aclasssqlite3controller_a7d6ff837161930eb903754d5688f1b9b_cgraph">
<area shape="rect" title="Initializes the SQLite database with the supplied databasename. The function will determine if the SQ..." alt="" coords="5,5,127,45"/>
<area shape="rect" href="classsqlite3controller.html#a9aa0232afbc7a8d2b71d330c607c5b40" title="This is called when a new SQLite database is created. The following tables are created: ." alt="" coords="175,5,296,45"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_a7d6ff837161930eb903754d5688f1b9b_icgraph.png" border="0" usemap="#aclasssqlite3controller_a7d6ff837161930eb903754d5688f1b9b_icgraph" alt=""/></div>
<map name="aclasssqlite3controller_a7d6ff837161930eb903754d5688f1b9b_icgraph" id="aclasssqlite3controller_a7d6ff837161930eb903754d5688f1b9b_icgraph">
<area shape="rect" title="Initializes the SQLite database with the supplied databasename. The function will determine if the SQ..." alt="" coords="327,5,448,45"/>
<area shape="rect" href="classfileintegritychecker.html#ad83727702919ed588145f7e9f9f183d7" title=" " alt="" coords="104,5,279,45"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,56,38"/>
</map>
</div>

</div>
</div>
<a id="a6bda68c0ea1d995b4fcf60965ab433a6" name="a6bda68c0ea1d995b4fcf60965ab433a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bda68c0ea1d995b4fcf60965ab433a6">&#9670;&#160;</a></span>save_dir_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sqlite3controller::save_dir_info </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the details of the directory. </p>
<div>This is the main entry point to saving the directory details. A call is made to checkIfDirectory exists to determine if the directory was previously discovered.</div> <div>If the directory exists, then the directory is marked as VERIFIED.</div> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td>Relative path with the directory name. Example: /foo/bar/parent </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 0 is returned if saved successfully. A -1 indicates an error occurred and unable to save the directory information. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a" title="Checks if the directory exists in the database.">checkIfDirectoryExist()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  244</span>                                                        {</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordtype">char</span> *zErrMsg = 0;</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordtype">char</span> *diradd_sql;</div>
<div class="line"><span class="lineno">  248</span>    sqlite3_stmt *<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>;</div>
<div class="line"><span class="lineno">  249</span>    </div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordtype">int</span> dirExists = <a class="code hl_function" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a">checkIfDirectoryExist</a>(dirname);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">if</span>(dirExists &gt; 1) {</div>
<div class="line"><span class="lineno">  253</span>        diradd_sql = <span class="stringliteral">&quot;UPDATE directories set dateverified=?, status=&#39;VERIFIED&#39; WHERE id=?; &quot;</span>;</div>
<div class="line"><span class="lineno">  254</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dirExists == 0) {</div>
<div class="line"><span class="lineno">  255</span>        diradd_sql = <span class="stringliteral">&quot;INSERT INTO directories (dirname,dateadded,machinename) VALUES (?,?,? ); &quot;</span>;</div>
<div class="line"><span class="lineno">  256</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  258</span>    }</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    rc = sqlite3_prepare_v3(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, diradd_sql, -1, 0, &amp;<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, NULL);</div>
<div class="line"><span class="lineno">  261</span>    </div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">if</span> (rc == SQLITE_OK) {</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">if</span>(dirExists &gt; 1) {</div>
<div class="line"><span class="lineno">  264</span>            sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 1, <a class="code hl_function" href="class_s_q_lite_helper.html#a33630720f2df387b6c543d33473138e4">SQLiteHelper::getCurrentTime</a>(), -1, NULL);</div>
<div class="line"><span class="lineno">  265</span>            sqlite3_bind_int(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 2, dirExists);</div>
<div class="line"><span class="lineno">  266</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  267</span>            sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 1, dirname, -1, NULL);</div>
<div class="line"><span class="lineno">  268</span>            sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 2, <a class="code hl_function" href="class_s_q_lite_helper.html#a33630720f2df387b6c543d33473138e4">SQLiteHelper::getCurrentTime</a>(), -1, NULL);</div>
<div class="line"><span class="lineno">  269</span>            sqlite3_bind_text(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>, 3, <a class="code hl_variable" href="sqlite3controller_8cpp.html#aadf24962fe0ba651d19e77bd6ed61b51">sqlite3_mname</a>, -1, NULL);</div>
<div class="line"><span class="lineno">  270</span>        }</div>
<div class="line"><span class="lineno">  271</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  272</span>        </div>
<div class="line"><span class="lineno">  273</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to execute statement: %s\n&quot;</span>, sqlite3_errmsg(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>));</div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  275</span>    }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    rc = sqlite3_step(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>);</div>
<div class="line"><span class="lineno">  278</span>    </div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">if</span> (rc == SQLITE_BUSY) {</div>
<div class="line"><span class="lineno">  280</span>        cout &lt;&lt; <span class="stringliteral">&quot;\nDatabase is busy&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">while</span> (rc == SQLITE_BUSY)</div>
<div class="line"><span class="lineno">  282</span>        {</div>
<div class="line"><span class="lineno">  283</span>            rc = sqlite3_step(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>);</div>
<div class="line"><span class="lineno">  284</span>        }</div>
<div class="line"><span class="lineno">  285</span>    }</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == SQLITE_ERROR) {</div>
<div class="line"><span class="lineno">  287</span>        printf(<span class="stringliteral">&quot;\nIn save_dir_info execution failed: %s\n&quot;</span>, sqlite3_errmsg(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>));</div>
<div class="line"><span class="lineno">  288</span>    }</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == SQLITE_MISUSE) {</div>
<div class="line"><span class="lineno">  290</span>        cout &lt;&lt; <span class="stringliteral">&quot;\nA MISUSE has been deteced in save_dir_info.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == SQLITE_DONE) {</div>
<div class="line"><span class="lineno">  293</span>        cout &lt;&lt; <span class="stringliteral">&quot;\nsqlite3_step executed successfully.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  294</span>    }</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  296</span>        cout &lt;&lt; <span class="stringliteral">&quot;\nNot sure what happened.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  297</span>    }</div>
<div class="line"><span class="lineno">  298</span>        </div>
<div class="line"><span class="lineno">  299</span>    sqlite3_finalize(<a class="code hl_variable" href="_s_q_lite_helper_8cpp.html#a67d1f816562e1a4851f044e829476aed">pStmt</a>);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">return</span> 0;  </div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>}</div>
<div class="ttc" id="aclass_s_q_lite_helper_html_a33630720f2df387b6c543d33473138e4"><div class="ttname"><a href="class_s_q_lite_helper.html#a33630720f2df387b6c543d33473138e4">SQLiteHelper::getCurrentTime</a></div><div class="ttdeci">static char * getCurrentTime()</div><div class="ttdoc">Will retrieve the current time.</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.cpp:334</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_cgraph.png" border="0" usemap="#aclasssqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_cgraph" alt=""/></div>
<map name="aclasssqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_cgraph" id="aclasssqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_cgraph">
<area shape="rect" title="Save the details of the directory." alt="" coords="5,35,127,75"/>
<area shape="rect" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a" title="Checks if the directory exists in the database." alt="" coords="199,5,345,45"/>
<area shape="rect" href="class_s_q_lite_helper.html#a33630720f2df387b6c543d33473138e4" title="Will retrieve the current time." alt="" coords="175,70,369,95"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_icgraph.png" border="0" usemap="#aclasssqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_icgraph" alt=""/></div>
<map name="aclasssqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_icgraph" id="aclasssqlite3controller_a6bda68c0ea1d995b4fcf60965ab433a6_icgraph">
<area shape="rect" title="Save the details of the directory." alt="" coords="476,59,597,99"/>
<area shape="rect" href="classfileintegritychecker.html#af2fb66e054e9f613677746f6f3dde0a3" title="Get the directories files object." alt="" coords="283,29,428,69"/>
<area shape="rect" href="classfileintegritychecker.html#ab064f5cb87b4a7d8c557a32d764a131a" title=" " alt="" coords="104,59,235,99"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,66,56,91"/>
</map>
</div>

</div>
</div>
<a id="ad24d1eff1c881ec79c608d4fbd5207b3" name="ad24d1eff1c881ec79c608d4fbd5207b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24d1eff1c881ec79c608d4fbd5207b3">&#9670;&#160;</a></span>save_file_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sqlite3controller::save_file_info </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>lastmodified</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintmax_t&#160;</td>
          <td class="paramname"><em>filesize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hashval</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the details of the file. </p>
<div>This is the main entry point to saving the file details. If the file is new then all of the required attributes are sent to <a class="el" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f" title="Entry point to saving the file information.">SQLiteHelper::saveFileInfo</a>.</div> <div>If the file exists, then the provided attributes are sent to <a class="el" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f" title="Entry point to saving the file information.">SQLiteHelper::saveFileInfo</a>.</div> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>Absolute file name. foo.bar </td></tr>
    <tr><td class="paramname">dirname</td><td>Relative path with the directory name. Example: /foo/bar/parent </td></tr>
    <tr><td class="paramname">lastmodified</td><td>The last modified date of the file. </td></tr>
    <tr><td class="paramname">filesize</td><td>The size of the file in bytes. </td></tr>
    <tr><td class="paramname">hashval</td><td>The hashed value of the file. The default value is NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 0 is returned if saved successfully. A -1 indicates an error occurred and unable to save the file information. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a" title="Checks if the directory exists in the database.">checkIfDirectoryExist()</a> </dd>
<dd>
<a class="el" href="class_s_q_lite_helper.html#a59fc305207ad616bafef83b54b102153" title="Returns the id of the file if the file exists in the files table.">SQLiteHelper::getFileId()</a> </dd>
<dd>
<a class="el" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f" title="Entry point to saving the file information.">SQLiteHelper::saveFileInfo()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td></td></tr>
    <tr><td class="paramname">dirname</td><td></td></tr>
    <tr><td class="paramname">lastmodified</td><td></td></tr>
    <tr><td class="paramname">filesize</td><td></td></tr>
    <tr><td class="paramname">hashval</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  211</span>                                                                                                                                         {</div>
<div class="line"><span class="lineno">  212</span>    </div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordtype">int</span> dir_id = <a class="code hl_function" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a">checkIfDirectoryExist</a>(dirname);</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordtype">int</span> fileExists = <a class="code hl_function" href="class_s_q_lite_helper.html#a59fc305207ad616bafef83b54b102153">SQLiteHelper::getFileId</a>(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, (<span class="keywordtype">char</span>*)fname, dir_id);</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">if</span>(fileExists &gt; 0) {</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> (lastmodified != NULL) {</div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_function" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f">SQLiteHelper::saveFileInfo</a>(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, dir_id, fname, filesize,lastmodified, NULL, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="class_s_q_lite_helper.html#a6ec2e82b83e64f66831dc36a7359c643a31c1958486003b1ae6d7f4b4823d7cc7">SQLiteHelper::AttributeToCheck::DateModified</a>);</div>
<div class="line"><span class="lineno">  220</span>        }</div>
<div class="line"><span class="lineno">  221</span>        <span class="keywordflow">if</span> (hashval != NULL) {</div>
<div class="line"><span class="lineno">  222</span>            <span class="comment">//fprintf(stderr, &quot;\nReceived hashedvalue of %s\n&quot;, hashval);</span></div>
<div class="line"><span class="lineno">  223</span>            <a class="code hl_function" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f">SQLiteHelper::saveFileInfo</a>(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, dir_id, fname, filesize, NULL, hashval, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="class_s_q_lite_helper.html#a6ec2e82b83e64f66831dc36a7359c643a69de2902ce804763ae1a21446ab8958f">SQLiteHelper::AttributeToCheck::HashedVal</a>);</div>
<div class="line"><span class="lineno">  224</span>        }</div>
<div class="line"><span class="lineno">  225</span>        <span class="keywordflow">if</span> (filesize &gt; 0) {</div>
<div class="line"><span class="lineno">  226</span>            <a class="code hl_function" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f">SQLiteHelper::saveFileInfo</a>(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, dir_id, fname, filesize, lastmodified, NULL, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="class_s_q_lite_helper.html#a6ec2e82b83e64f66831dc36a7359c643aaba31fc2353550dcadd7ac225e31dc02">SQLiteHelper::AttributeToCheck::FileSize</a>);</div>
<div class="line"><span class="lineno">  227</span>        }</div>
<div class="line"><span class="lineno">  228</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fileExists == 0) {</div>
<div class="line"><span class="lineno">  229</span>        <a class="code hl_function" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f">SQLiteHelper::saveFileInfo</a>(<a class="code hl_variable" href="sqlite3controller_8cpp.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, dir_id, fname, filesize, lastmodified, hashval, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  230</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>}</div>
<div class="ttc" id="aclass_s_q_lite_helper_html_a10508781dbcc903c632e83c1527da36f"><div class="ttname"><a href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f">SQLiteHelper::saveFileInfo</a></div><div class="ttdeci">static int saveFileInfo(sqlite3 *db, const int dir_id, const char *file_name, const int file_size=0, const char *date_modified=NULL, const char *hashed_val=NULL, const bool isNew=true, AttributeToCheck attr_to_update=AttributeToCheck::NONE)</div><div class="ttdoc">Entry point to saving the file information.</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.cpp:357</div></div>
<div class="ttc" id="aclass_s_q_lite_helper_html_a59fc305207ad616bafef83b54b102153"><div class="ttname"><a href="class_s_q_lite_helper.html#a59fc305207ad616bafef83b54b102153">SQLiteHelper::getFileId</a></div><div class="ttdeci">static int getFileId(sqlite3 *db)</div><div class="ttdoc">Returns the id of the file if the file exists in the files table.</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.cpp:288</div></div>
<div class="ttc" id="aclass_s_q_lite_helper_html_a6ec2e82b83e64f66831dc36a7359c643a31c1958486003b1ae6d7f4b4823d7cc7"><div class="ttname"><a href="class_s_q_lite_helper.html#a6ec2e82b83e64f66831dc36a7359c643a31c1958486003b1ae6d7f4b4823d7cc7">SQLiteHelper::DateModified</a></div><div class="ttdeci">@ DateModified</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.h:26</div></div>
<div class="ttc" id="aclass_s_q_lite_helper_html_a6ec2e82b83e64f66831dc36a7359c643a69de2902ce804763ae1a21446ab8958f"><div class="ttname"><a href="class_s_q_lite_helper.html#a6ec2e82b83e64f66831dc36a7359c643a69de2902ce804763ae1a21446ab8958f">SQLiteHelper::HashedVal</a></div><div class="ttdeci">@ HashedVal</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.h:26</div></div>
<div class="ttc" id="aclass_s_q_lite_helper_html_a6ec2e82b83e64f66831dc36a7359c643aaba31fc2353550dcadd7ac225e31dc02"><div class="ttname"><a href="class_s_q_lite_helper.html#a6ec2e82b83e64f66831dc36a7359c643aaba31fc2353550dcadd7ac225e31dc02">SQLiteHelper::FileSize</a></div><div class="ttdeci">@ FileSize</div><div class="ttdef"><b>Definition:</b> SQLiteHelper.h:26</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_cgraph.png" border="0" usemap="#aclasssqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_cgraph" alt=""/></div>
<map name="aclasssqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_cgraph" id="aclasssqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_cgraph">
<area shape="rect" title="Save the details of the file." alt="" coords="5,73,127,113"/>
<area shape="rect" href="classsqlite3controller.html#afad285c88925ab4bb987583563c11d8a" title="Checks if the directory exists in the database." alt="" coords="189,16,335,56"/>
<area shape="rect" href="class_s_q_lite_helper.html#a59fc305207ad616bafef83b54b102153" title="Returns the id of the file if the file exists in the files table." alt="" coords="665,19,821,45"/>
<area shape="rect" href="class_s_q_lite_helper.html#a10508781dbcc903c632e83c1527da36f" title="Entry point to saving the file information." alt="" coords="175,198,349,223"/>
<area shape="rect" href="class_s_q_lite_helper.html#af16a7fbd53573503bfa21c97eea53efb" title=" " alt="" coords="407,191,587,231"/>
<area shape="rect" href="class_s_q_lite_helper.html#a843ad9e365ed3bc8d6d8baf38600fdc0" title=" " alt="" coords="397,347,596,373"/>
<area shape="rect" href="class_s_q_lite_helper.html#a373f87d1a12fb0d1014b4e01a7288521" title="Determines if the provided attribute has changed its value." alt="" coords="644,69,841,109"/>
<area shape="rect" href="class_s_q_lite_helper.html#a6329b4efc28fd0442a6cc25246cc4fb5" title="Determines if the provided attribute is in the changes table." alt="" coords="644,133,841,173"/>
<area shape="rect" href="class_s_q_lite_helper.html#a33630720f2df387b6c543d33473138e4" title="Will retrieve the current time." alt="" coords="893,319,1087,345"/>
<area shape="rect" href="class_s_q_lite_helper.html#a53e8c824b040560b8bb1393a853f265a" title=" " alt="" coords="649,248,836,288"/>
<area shape="rect" href="class_s_q_lite_helper.html#a65965633aef3f5a34884740c497a61dc" title=" " alt="" coords="661,312,825,352"/>
<area shape="rect" href="class_s_q_lite_helper.html#a7f4941d87b3ea71d1691f62b0113999a" title=" " alt="" coords="644,376,841,416"/>
<area shape="rect" href="class_s_q_lite_helper.html#ad0fbfec9fab919ce001e2ca3a2f3d2d3" title=" " alt="" coords="891,5,1089,45"/>
<area shape="rect" href="class_s_q_lite_helper.html#ab551977b252cab42efd1f3b06676d7b1" title=" " alt="" coords="905,69,1075,109"/>
<area shape="rect" href="class_s_q_lite_helper.html#aa733abbf8352e42fbcda544c13b5e4f1" title=" " alt="" coords="889,133,1091,173"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_icgraph.png" border="0" usemap="#aclasssqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_icgraph" alt=""/></div>
<map name="aclasssqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_icgraph" id="aclasssqlite3controller_ad24d1eff1c881ec79c608d4fbd5207b3_icgraph">
<area shape="rect" title="Save the details of the file." alt="" coords="476,29,597,69"/>
<area shape="rect" href="classfileintegritychecker.html#af2fb66e054e9f613677746f6f3dde0a3" title="Get the directories files object." alt="" coords="283,29,428,69"/>
<area shape="rect" href="classfileintegritychecker.html#ab064f5cb87b4a7d8c557a32d764a131a" title=" " alt="" coords="104,29,235,69"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,37,56,62"/>
</map>
</div>

</div>
</div>
<a id="ac0c940ac721d94e09be08e38eb0e5ca4" name="ac0c940ac721d94e09be08e38eb0e5ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0c940ac721d94e09be08e38eb0e5ca4">&#9670;&#160;</a></span>setDATABASENAME()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlite3controller::setDATABASENAME </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dbasename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the name of the SQLite database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dbasename</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   21</span>                                                          {</div>
<div class="line"><span class="lineno">   22</span>    <a class="code hl_variable" href="sqlite3controller_8cpp.html#a89983a6d628aa726003d2a29bc372df4">sqlite3_dbasename</a> = databasename;</div>
<div class="line"><span class="lineno">   23</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a87910e834388b6f11c8493f10fd6a576" name="a87910e834388b6f11c8493f10fd6a576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87910e834388b6f11c8493f10fd6a576">&#9670;&#160;</a></span>setMACHINENAME()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlite3controller::setMACHINENAME </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>machinename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the machine name where the FileIntegrityApplication is running on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machinename</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   26</span>                                                        {</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_variable" href="sqlite3controller_8cpp.html#aadf24962fe0ba651d19e77bd6ed61b51">sqlite3_mname</a> = <a class="code hl_variable" href="mysqlcontroller_8cpp.html#a305d17d000ed63060cc0e874bf27e05c">machinename</a>;</div>
<div class="line"><span class="lineno">   28</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
